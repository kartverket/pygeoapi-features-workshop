services:
  pygeoapi:
    image: geopython/pygeoapi:latest                # 'Sti' til image. Vi bruker 'latest' versjon her, men det er ofte lurt 책 spesifisere med versjonsnummer
    container_name: pygeoapi_ws                        # valgfritt, men det er fint 책 sette eget container navn
    ports:
      - "5000:80"                                   # Her 'mappes' port 80 i containeren med port 5000 p책 pc'en din
    restart: unless-stopped                         # Containeren restarter seg selv, med mindre den f책r en stopp-kommando. Eks. 'docker compose down'
    environment:
      - DB_NAME=administrative_enheter
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=qwer1234
      - POSTGRES_HOST=postgis
      - POSTGRES_DB=administrative_enheter

  postgis:
    build:
      context: ./assets/postgis # Sti til postgismappen som inneholder en Dockerfile
    container_name: postgis
    ports:
      - "5432:5432"
    environment:
      - DB_NAME=administrative_enheter
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=qwer1234
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U postgres"]
      interval: 5s
      timeout: 5s
      retries: 10